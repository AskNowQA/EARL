#!/usr/bin/python

import json,sys
import itertools
from operator import itemgetter
from pybloom import BloomFilter


class JointLinker:
    def __init__(self):
        print "Joint Linker initializing"
        try:
            f = open('../data/blooms/bloom1hoppredicate.pickle')
            self.bloom1hoppred = BloomFilter.fromfile(f)
            f.close()
            f = open('../data/blooms/bloom1hopentity.pickle')
            self.bloom1hopentity = BloomFilter.fromfile(f)
            f.close()
            f = open('../data/blooms/bloom2hoppredicate.pickle')
            self.bloom2hoppredicate = BloomFilter.fromfile(f)
            f.close()
            f = open('../data/blooms/bloom2hoptypeofentity.pickle')
            self.bloom2hoptypeofentity = BloomFilter.fromfile(f)
            f.close()
        except Exception,e:
            print e
            sys.exit(1)
        print "Joint Linker initialized"

    def jointLinker(self, topklists):
        lists = []
        chunktexts = []
        ertypes = []
        for chunk in topklists:
            lists.append(chunk['topkmatches'])
            chunktexts.append(chunk['chunk']) 
            ertypes.append(chunk['class'])
        sequence = range(len(lists))
        nodestats = {}
        count = 0
        for listt in lists:
            rank = 0
            if count not in nodestats:
                nodestats[count] = {}
            for uri in listt:
                rank += 1
                if uri[0] not in nodestats[count]:
                    nodestats[count][uri[0]] = {'connections':0, 'sumofhops':0, 'esrank': rank, 'edgecount': uri[1], 'fuzz1': uri[2]  ,'fuzz2': uri[3] , 'fuzz3': uri[4] , 'fuzz4': uri[5] }
            if len(nodestats[count]) == 0:
                nodestats[count]['null'] = {'connections':0, 'sumofhops':0, 'esrank': 100, 'edgecount': -1, 'fuzz1': -1 ,'fuzz2': -1, 'fuzz3': -1, 'fuzz4': -1}
            count += 1
        for permutation in itertools.permutations(sequence, 2):
            for uri1 in lists[permutation[0]]:
                for uri2 in lists[permutation[1]]:
                    bloomstring = uri1[0]+':'+uri2[0]
                    if bloomstring in self.bloom1hoppred:
                        nodestats[permutation[0]][uri1[0]]['connections'] += 1
                        nodestats[permutation[0]][uri1[0]]['sumofhops'] += 0.5
                        nodestats[permutation[1]][uri2[0]]['connections'] += 1
                        nodestats[permutation[1]][uri2[0]]['sumofhops'] += 0.5
                    elif bloomstring in self.bloom1hopentity:
                        nodestats[permutation[0]][uri1[0]]['connections'] += 1
                        nodestats[permutation[0]][uri1[0]]['sumofhops'] += 1
                        nodestats[permutation[1]][uri2[0]]['connections'] += 1
                        nodestats[permutation[1]][uri2[0]]['sumofhops'] += 1
                    elif bloomstring in self.bloom2hoppredicate:
                        nodestats[permutation[0]][uri1[0]]['connections'] += 1
                        nodestats[permutation[0]][uri1[0]]['sumofhops'] += 1.5
                        nodestats[permutation[1]][uri2[0]]['connections'] += 1
                        nodestats[permutation[1]][uri2[0]]['sumofhops'] += 1.5
                    elif bloomstring in self.bloom2hoptypeofentity:
                        nodestats[permutation[0]][uri1[0]]['connections'] += 1
                        nodestats[permutation[0]][uri1[0]]['sumofhops'] += 2
                        nodestats[permutation[1]][uri2[0]]['connections'] += 1
                        nodestats[permutation[1]][uri2[0]]['sumofhops'] += 2
        for k1,v1 in nodestats.iteritems():
            maxconn = 0.01
            maxhop = 0.01
            maxesrank = 0.01
            for k2,v2 in v1.iteritems():
                if nodestats[k1][k2]['connections'] > maxconn:
                    maxconn = nodestats[k1][k2]['connections']
                if nodestats[k1][k2]['sumofhops'] > maxhop:
                    maxhop = nodestats[k1][k2]['sumofhops']
                if nodestats[k1][k2]['esrank'] > maxesrank:
                   maxesrank = nodestats[k1][k2]['esrank']
            for k2,v2 in v1.iteritems():
                nodestats[k1][k2]['connections'] /= float(maxconn)*float(len(lists))
                nodestats[k1][k2]['sumofhops'] /= float(maxhop)*float(len(lists))
                nodestats[k1][k2]['esrank'] = 1.0 - (nodestats[k1][k2]['esrank']/float(maxesrank))
            
        return {'nodefeatures': nodestats, 'chunktext': chunktexts, 'ertypes': ertypes}
    

if __name__ == '__main__':
    j = JointLinker()
    print(j.jointLinker([{'chunk': {'chunk': 'Who', 'surfacelength': 3, 'class': 'entity', 'surfacestart': 0}, 'topkmatches': [('http://dbpedia.org/resource/Who_Is_the_Craftiest', 113, 65, 65, 60, 75), ('http://dbpedia.org/resource/Who_is_the_Guilty%3F', 73, 63, 61, 59, 74), ('http://dbpedia.org/resource/Who_Is_the_Sender%3F', 100, 63, 67, 76, 76), ('http://dbpedia.org/resource/Who_Is_the_Champion%3F', 80, 60, 60, 56, 72), (u"http://dbpedia.org/resource/Who's_in_the_House", 53, 58, 61, 63, 63), ('http://dbpedia.org/resource/Who_Is_the_Man%3F', 92, 57, 60, 71, 83), ('http://dbpedia.org/resource/Who_Was_the_Man%3F', 88, 56, 56, 51, 64), (u"http://dbpedia.org/resource/Who's_the_Man%3F", 232, 53, 57, 61, 70), ('http://dbpedia.org/resource/Who_Goes_There', 28, 53, 64, 59, 59), ('http://dbpedia.org/resource/Who_is_Hussain', 38, 53, 43, 53, 60), (u"http://dbpedia.org/resource/Who's_the_Caboose%3F", 143, 53, 56, 59, 59), (u"http://dbpedia.org/resource/Who's_the_Ass%3F", 43, 53, 64, 67, 70), ('http://dbpedia.org/resource/Who_Gets_the_Love%3F', 72, 53, 56, 59, 59), ('http://dbpedia.org/resource/Who_Is_Without_Sin', 156, 53, 56, 63, 68), ('http://dbpedia.org/resource/Who_the_Hell_Is_Juliette%3F', 146, 53, 55, 64, 68), (u"http://dbpedia.org/resource/Who's_the_Boss%3F", 720, 51, 60, 65, 67), ('http://dbpedia.org/resource/Who_Goes_There%3F', 185, 51, 60, 59, 59), ('http://dbpedia.org/resource/Who_Goes_There!', 136, 51, 60, 59, 59), (u"http://dbpedia.org/resource/Who's_the_Enemy", 86, 51, 60, 57, 64), ('http://dbpedia.org/resource/Who_Are_These_Children%3F', 42, 51, 50, 67, 67), ('http://dbpedia.org/resource/Who_is_Thanassis', 140, 50, 56, 50, 55), ('http://dbpedia.org/resource/Who_is_to_Blame%3F', 62, 50, 56, 46, 57), ('http://dbpedia.org/resource/Who_is_to_blame%3F', 23, 50, 56, 46, 57), ('http://dbpedia.org/resource/Who_is_Undercover', 11, 49, 53, 54, 54), ('http://dbpedia.org/resource/Who_Shot_the_Sheriff%3F', 87, 49, 50, 60, 60), ('http://dbpedia.org/resource/Who_Gets_the_Dog%3F', 37, 49, 53, 61, 61), ('http://dbpedia.org/resource/Who_is_a_Jew%3F', 599, 48, 54, 50, 67), (u"http://dbpedia.org/resource/Who's_Missing", 22, 48, 38, 61, 61), ('http://dbpedia.org/resource/Who_Are_The_Guilty', 42, 47, 44, 63, 63), ('http://dbpedia.org/resource/Who_We_Are', 56, 47, 50, 53, 53), ('http://dbpedia.org/resource/This_Is_Who_We_Are', 29, 47, 50, 58, 68), ('http://dbpedia.org/resource/Who_Are_the_Skulls', 77, 47, 50, 58, 58), ('http://dbpedia.org/resource/Who_the_(Bleep)...', 129, 47, 50, 61, 70), ('http://dbpedia.org/resource/Who_Got_the_Gravy%3F', 82, 47, 50, 54, 58), ('http://dbpedia.org/resource/The_Girl_Who_Dared', 96, 47, 50, 58, 58), ('http://dbpedia.org/resource/Who_Came_First', 236, 47, 43, 47, 47), (u"http://dbpedia.org/resource/Who's_on_First%3F", 255, 46, 47, 53, 53), ('http://dbpedia.org/resource/Who_is_Gary_Burton%3F', 83, 46, 47, 37, 53), ('http://dbpedia.org/resource/The_God_Who_Is_There', 85, 45, 46, 60, 67), (u"http://dbpedia.org/resource/Who's_Whose", 120, 45, 55, 45, 52), ('http://dbpedia.org/resource/Who_Moved_the_Stone%3F', 10, 45, 46, 56, 56), ('http://dbpedia.org/resource/Who_Is,_This_Is%3F', 105, 44, 50, 65, 71), ('http://dbpedia.org/resource/Who_the_Fuck_Is_That%3F', 110, 44, 45, 60, 67), ('http://dbpedia.org/resource/Who_Is_Undercover', 74, 43, 47, 54, 54), ('http://dbpedia.org/resource/The_Man_Who_Cried', 382, 43, 47, 65, 65), (u"http://dbpedia.org/resource/Who's_to_Know", 96, 42, 46, 48, 48), ('http://dbpedia.org/resource/Who_Was_That_Lady%3F', 163, 42, 44, 43, 43), (u"http://dbpedia.org/resource/Who's_Afraid%3F", 121, 42, 38, 50, 50), ('http://dbpedia.org/resource/Who_You_Really_Are', 144, 42, 44, 42, 42), ('http://dbpedia.org/resource/Who_Is_It', 34, 41, 67, 62, 80), (u"http://dbpedia.org/resource/Who's_That_Man", 147, 41, 43, 53, 53), ('http://dbpedia.org/resource/Who_is_Silvia%3F', 10, 41, 43, 55, 63), ('http://dbpedia.org/resource/Who_Said_That%3F', 164, 41, 43, 61, 61), (u"http://dbpedia.org/resource/Who's_That_Soldier%3F", 74, 41, 42, 63, 63), ('http://dbpedia.org/resource/This_Is_Who_You_Are', 73, 41, 42, 51, 62), (u"http://dbpedia.org/resource/Who's_Quentin%3F", 75, 41, 36, 48, 48), ('http://dbpedia.org/resource/Who_Cares', 39, 41, 56, 48, 50), ('http://dbpedia.org/resource/Who_We_Be', 127, 41, 44, 48, 50), ('http://dbpedia.org/resource/Who_Goes_Next%3F', 60, 41, 44, 48, 48), ('http://dbpedia.org/resource/Who_Can_See_It', 217, 41, 43, 53, 53), (u"http://dbpedia.org/resource/Who's_Last", 183, 40, 50, 47, 47), (u"http://dbpedia.org/resource/Who's_Next", 646, 40, 50, 47, 47), ('http://dbpedia.org/resource/Who_Is_Running%3F', 91, 40, 33, 59, 60), ('http://dbpedia.org/resource/Those_Who_Watch', 55, 40, 40, 51, 51), ('http://dbpedia.org/resource/Who_Is_Wonder_Woman%3F', 73, 40, 40, 36, 51), ('http://dbpedia.org/resource/Who_Was_It%3F', 54, 39, 55, 47, 47), (u"http://dbpedia.org/resource/Who's_That_Girl%3F", 72, 39, 44, 57, 57), ('http://dbpedia.org/resource/Who_Is_To_Blame%3F', 54, 39, 44, 46, 57), ('http://dbpedia.org/resource/Who_You_Are', 53, 39, 45, 39, 45), ('http://dbpedia.org/resource/Who_Will_Answer%3F', 73, 39, 44, 34, 40), ('http://dbpedia.org/resource/Who_You_Wit', 108, 39, 45, 32, 45), ('http://dbpedia.org/resource/The_Prince_Who_Was_a_Thief', 130, 39, 40, 61, 61), (u"http://dbpedia.org/resource/Who's_Irish%3F", 34, 38, 50, 52, 52), ('http://dbpedia.org/resource/Who_Is_Fancy', 160, 38, 42, 38, 67), (u"http://dbpedia.org/resource/Who's_Johnny", 137, 38, 42, 38, 40), (u"http://dbpedia.org/resource/Who's_That_Chick%3F", 331, 38, 41, 56, 56), ('http://dbpedia.org/resource/Who_Governs%3F', 38, 38, 33, 39, 43), (u"http://dbpedia.org/resource/Who's_Guilty", 11, 38, 42, 44, 44), (u"http://dbpedia.org/resource/Who's_David%3F", 11, 38, 33, 45, 45), (u"http://dbpedia.org/resource/Who's_for_Tennis%3F", 12, 38, 41, 50, 50), ('http://dbpedia.org/resource/Who_Done_It%3F', 36, 38, 42, 52, 52), ('http://dbpedia.org/resource/Doctor_Who:_The_Commentaries', 150, 38, 45, 55, 55), ('http://dbpedia.org/resource/Who_Makes_Movies%3F', 51, 38, 41, 44, 44), ('http://dbpedia.org/resource/Indian_Muslims:_Who_Are_They', 68, 38, 41, 55, 55), ('http://dbpedia.org/resource/Who_See', 238, 37, 43, 52, 60), ('http://dbpedia.org/resource/The_Who_by_Numbers', 311, 37, 39, 58, 58), ('http://dbpedia.org/resource/The_Who_Collection', 159, 37, 39, 58, 58), (u"http://dbpedia.org/resource/Who's_in_a_Family%3F", 63, 37, 39, 49, 49), ('http://dbpedia.org/resource/Who_Are_You_(song)', 302, 37, 39, 44, 50), ('http://dbpedia.org/resource/Who_Will_I_Run_To%3F', 79, 37, 33, 54, 54), (u"http://dbpedia.org/resource/Who's_Guilty%3F", 134, 36, 38, 44, 44), ('http://dbpedia.org/resource/They_Who_Dare', 174, 36, 46, 61, 61), (u"http://dbpedia.org/resource/Who's_Bigger%3F", 77, 36, 46, 44, 44), ('http://dbpedia.org/resource/Who_Then_Now%3F', 74, 36, 46, 56, 56), ('http://dbpedia.org/resource/Who_Said', 157, 36, 50, 50, 55), ('http://dbpedia.org/resource/Who_(pronoun)', 143, 36, 38, 45, 45), ('http://dbpedia.org/resource/The_Ghost_Who_Walks', 113, 36, 37, 51, 56), ('http://dbpedia.org/resource/The_Seeker_(The_Who_song)', 230, 36, 30, 60, 62), ('http://dbpedia.org/resource/The_Who_1964_performances', 163, 36, 40, 58, 58), ('http://dbpedia.org/resource/The_Story_of_The_Who', 131, 35, 35, 55, 61)], 'class': 'entity'}, {'chunk': {'chunk': 'Barack Obama', 'surfacelength': 12, 'class': 'entity', 'surfacestart': 34}, 'topkmatches': [('http://dbpedia.org/resource/Timeline_of_the_presidency_of_Barack_Obama', 36, 45, 70, 45, 47), ('http://dbpedia.org/resource/Barack_Obama_presidential_campaign', 34, 41, 55, 41, 41), ('http://dbpedia.org/resource/Timeline_of_the_presidency_of_Barack_Obama_(2013)', 340, 41, 70, 42, 44), ('http://dbpedia.org/resource/Timeline_of_the_presidency_of_Barack_Obama_(2014)', 298, 41, 70, 42, 44), ('http://dbpedia.org/resource/Timeline_of_the_presidency_of_Barack_Obama_(2009)', 1019, 41, 70, 42, 44), ('http://dbpedia.org/resource/Timeline_of_the_presidency_of_Barack_Obama_(2015)', 330, 41, 70, 42, 44), ('http://dbpedia.org/resource/Timeline_of_the_presidency_of_Barack_Obama_(2011)', 370, 41, 70, 42, 44), ('http://dbpedia.org/resource/Timeline_of_the_presidency_of_Barack_Obama_(2010)', 524, 41, 70, 42, 44), ('http://dbpedia.org/resource/Timeline_of_the_presidency_of_Barack_Obama_(2012)', 246, 41, 70, 42, 44), ('http://dbpedia.org/resource/Timeline_of_the_presidency_of_Barack_Obama_(2016)', 124, 41, 70, 42, 44), ('http://dbpedia.org/resource/Barack_the_Barbarian', 141, 40, 41, 40, 40), ('http://dbpedia.org/resource/List_of_presidential_trips_made_by_Barack_Obama', 11, 39, 55, 42, 42), ('http://dbpedia.org/resource/The_Other_Barack', 76, 39, 44, 39, 39), ('http://dbpedia.org/resource/Barack_Obama_Presidential_Center', 119, 38, 50, 38, 38), (u"http://dbpedia.org/resource/First_100_days_of_Barack_Obama's_presidency", 537, 38, 55, 38, 38), ('http://dbpedia.org/resource/Barack_Obama_presidential_campaign,_2012', 439, 37, 55, 37, 37), ('http://dbpedia.org/resource/Barack_Obama_presidential_campaign,_2008', 822, 37, 55, 37, 37), ('http://dbpedia.org/resource/List_of_international_presidential_trips_made_by_Barack_Obama', 1351, 37, 55, 35, 35), ('http://dbpedia.org/resource/The_Obama_Identity', 85, 37, 39, 47, 58), ('http://dbpedia.org/resource/Obama_Nishi_Interchange', 65, 37, 40, 37, 37), ('http://dbpedia.org/resource/Assassination_threats_against_Barack_Obama', 236, 36, 37, 26, 26), ('http://dbpedia.org/resource/Moises_Barack', 96, 36, 46, 24, 24), ('http://dbpedia.org/resource/Foreign_policy_of_the_Barack_Obama_administration', 11, 35, 40, 32, 38), (u"http://dbpedia.org/resource/Oprah_Winfrey's_endorsement_of_Barack_Obama", 152, 35, 45, 32, 32), ('http://dbpedia.org/resource/Assassination_threats_against_Barack_Obama', 236, 35, 35, 25, 25), (u"http://dbpedia.org/resource/Confirmations_of_Barack_Obama's_Cabinet", 481, 34, 30, 27, 27), ('http://dbpedia.org/resource/Illinois_Senate_career_of_Barack_Obama', 248, 34, 50, 28, 28), ('http://dbpedia.org/resource/Medical_marijuana_policy_of_the_presidential_administration_of_Barack_Obama', 52, 34, 75, 34, 35), ('http://dbpedia.org/resource/Foreign_policy_of_the_Barack_Obama', 11, 33, 40, 33, 41), ('http://dbpedia.org/resource/The_Case_Against_Barack_Obama', 116, 33, 40, 41, 49), ('http://dbpedia.org/resource/Illinois_Senate_elections_of_Barack_Obama', 253, 33, 50, 26, 26), ('http://dbpedia.org/resource/Space_policy_of_the_Barack_Obama_administration', 178, 33, 40, 30, 33), ('http://dbpedia.org/resource/Barack_Obama_religion_conspiracy_theories', 203, 33, 45, 36, 36), ('http://dbpedia.org/resource/Invitations_to_the_first_inauguration_of_Barack_Obama', 107, 33, 55, 36, 36), ('http://dbpedia.org/resource/Barack_Obama_presidential_campaign_endorsements', 37, 33, 55, 36, 36), ('http://dbpedia.org/resource/Barack_Obama_judicial_appointment_controversies', 287, 33, 45, 30, 30), ('http://dbpedia.org/resource/List_of_presidential_trips_made_by_Barack_Obama_during_2014', 659, 33, 55, 35, 35), ('http://dbpedia.org/resource/The_Obama_Nation', 272, 33, 31, 33, 44), ('http://dbpedia.org/resource/List_of_presidential_trips_made_by_Barack_Obama_during_2011', 482, 33, 55, 35, 35), ('http://dbpedia.org/resource/List_of_presidential_trips_made_by_Barack_Obama_during_2013', 599, 33, 55, 35, 35), ('http://dbpedia.org/resource/List_of_presidential_trips_made_by_Barack_Obama_during_2012', 562, 33, 55, 35, 35), ('http://dbpedia.org/resource/List_of_presidential_trips_made_by_Barack_Obama_during_2010', 728, 33, 55, 35, 35), ('http://dbpedia.org/resource/List_of_presidential_trips_made_by_Barack_Obama_during_2015', 513, 33, 55, 35, 35), ('http://dbpedia.org/resource/List_of_presidential_trips_made_by_Barack_Obama_during_2016', 180, 33, 55, 35, 35), ('http://dbpedia.org/resource/List_of_presidential_trips_made_by_Barack_Obama_during_2009', 441, 33, 55, 35, 35), ('http://dbpedia.org/resource/Newspaper_endorsements_in_the_United_States_presidential_election,_2008,_for_Barack_Obama', 992, 33, 65, 32, 32), ('http://dbpedia.org/resource/Barack_the_Magic_Negro', 129, 33, 35, 33, 38), ('http://dbpedia.org/resource/Energy_policy_of_the_Obama_administration', 53, 33, 40, 33, 39), ('http://dbpedia.org/resource/Obama:_From_Promise_to_Power', 116, 33, 40, 34, 34), ('http://dbpedia.org/resource/Assassination_threats_against_Barack_Obama', 236, 32, 50, 35, 35), ('http://dbpedia.org/resource/Barack_Obama_Male_Leadership_Academy', 145, 32, 35, 32, 32), ('http://dbpedia.org/resource/Barack_Obama_presidential_eligibility_litigation', 400, 32, 55, 32, 32), ('http://dbpedia.org/resource/Barack_Obama_presidential_primary_campaign,_2008', 803, 32, 55, 36, 36), ('http://dbpedia.org/resource/List_of_unofficial_events_for_the_first_inauguration_of_Barack_Obama', 88, 32, 50, 30, 31), ('http://dbpedia.org/resource/List_of_Barack_Obama_presidential_campaign_endorsements,_2012', 1360, 32, 55, 30, 30), ('http://dbpedia.org/resource/South_Asian_foreign_policy_of_the_Barack_Obama_administration', 214, 32, 40, 30, 32), ('http://dbpedia.org/resource/List_of_Barack_Obama_presidential_campaign_endorsements,_2008', 1992, 32, 55, 30, 30), ('http://dbpedia.org/resource/The_Obama_Diaries', 82, 32, 35, 43, 54), ('http://dbpedia.org/resource/List_of_bills_sponsored_by_Barack_Obama_in_the_United_States_Senate', 355, 32, 50, 30, 32), ('http://dbpedia.org/resource/List_of_Barack_Obama_presidential_campaign_staff_members,_2008', 130, 32, 55, 35, 35), ('http://dbpedia.org/resource/Phas_Gaye_Re_Obama', 162, 32, 33, 26, 26), ('http://dbpedia.org/resource/Barack_Obama_Leadership_Academy', 10, 31, 35, 31, 31), ('http://dbpedia.org/resource/List_of_people_pardoned_by_Barack_Obama', 100, 31, 40, 34, 34), ('http://dbpedia.org/resource/List_of_topics_related_to_Barack_Obama', 117, 31, 45, 34, 34), ('http://dbpedia.org/resource/Barack_Obama_citizenship_conspiracy_theories', 785, 31, 45, 31, 31), ('http://dbpedia.org/resource/The_Bridge:_The_Life_and_Rise_of_Barack_Obama', 77, 31, 45, 34, 37), ('http://dbpedia.org/resource/European_foreign_policy_of_the_Barack_Obama_administration', 239, 31, 35, 31, 36), ('http://dbpedia.org/resource/List_of_things_named_after_Barack_Obama', 125, 31, 40, 27, 27), ('http://dbpedia.org/resource/Hope!_\u2013_Das_Obama_Musical', 88, 31, 31, 38, 38), ('http://dbpedia.org/resource/Presidency_of_Barack_Obama', 2349, 30, 35, 39, 39), ('http://dbpedia.org/resource/Barack_Obama_on_mass_surveillance', 102, 30, 40, 26, 26), ('http://dbpedia.org/resource/List_of_trips_made_by_Barack_Obama', 11, 30, 35, 30, 30), ('http://dbpedia.org/resource/Barack_Obama:_Der_schwarze_Kennedy', 97, 30, 35, 26, 26), ('http://dbpedia.org/resource/East_Asian_foreign_policy_of_the_Barack_Obama_administration', 257, 30, 40, 30, 35), ('http://dbpedia.org/resource/Florent_Obama', 130, 30, 31, 36, 36), ('http://dbpedia.org/resource/Assassination_threats_against_Barack_Obama', 236, 30, 35, 33, 33), ('http://dbpedia.org/resource/Obama_Castle_(Fukui)', 86, 30, 32, 26, 26), ('http://dbpedia.org/resource/Obama_Castle_(Mutsu)', 89, 30, 32, 32, 32), ('http://dbpedia.org/resource/By_the_People:_The_Election_of_Barack_Obama', 101, 29, 40, 35, 34), ('http://dbpedia.org/resource/Political_positions_of_Barack_Obama', 181, 29, 30, 25, 25), ('http://dbpedia.org/resource/Barack_Obama_Tucson_memorial_speech', 182, 29, 35, 29, 29), ('http://dbpedia.org/resource/Native_American_Policy_of_the_Barack_Obama_Administration', 11, 29, 40, 29, 34), ('http://dbpedia.org/resource/List_of_federal_judges_appointed_by_barack_obama', 11, 29, 35, 29, 29), ('http://dbpedia.org/resource/Barack_Obama_Selma_50th_anniversary_speech', 79, 29, 40, 29, 29), ('http://dbpedia.org/resource/United_States_Senate_career_of_Barack_Obama', 422, 29, 40, 35, 35), ('http://dbpedia.org/resource/List_of_federal_judges_appointed_by_Barack_Obama', 387, 29, 35, 29, 29), ('http://dbpedia.org/resource/Barack_Obama_Male_Leadership_Academy_at_BF_Darrell', 10, 29, 35, 26, 26), ('http://dbpedia.org/resource/Middle_Eastern_foreign_policy_of_the_Barack_Obama_administration', 202, 29, 40, 31, 36), ('http://dbpedia.org/resource/Barack_Obama_speech_to_joint_session_of_Congress,_September_2009', 126, 29, 50, 31, 31), ('http://dbpedia.org/resource/The_Obama_Story', 74, 29, 33, 40, 46), ('http://dbpedia.org/resource/Obama_(disambiguation)', 102, 29, 32, 30, 30), ('http://dbpedia.org/resource/Obama_Doctrine', 199, 29, 36, 35, 35), (u"http://dbpedia.org/resource/2016:_Obama's_America", 200, 29, 32, 25, 25), ('http://dbpedia.org/resource/Higashi-Obama_Station', 103, 29, 32, 34, 34), ('http://dbpedia.org/resource/Barack_Obama:_The_Story', 41, 28, 30, 33, 38), ('http://dbpedia.org/resource/Barack_Obama_Supreme_Court_candidates', 293, 28, 35, 28, 28), ('http://dbpedia.org/resource/Barack_(disambiguation)', 41, 28, 32, 24, 24), ('http://dbpedia.org/resource/Etheostoma_obama', 107, 28, 31, 33, 33), ('http://dbpedia.org/resource/Obama_On_My_Mind', 57, 28, 31, 28, 28), ('http://dbpedia.org/resource/Barack_Obama:_Der_schwarze_Kennedy', 97, 28, 35, 26, 26)], 'class': 'entity'}]))
